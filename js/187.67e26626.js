"use strict";(self["webpackChunkcafe_today"]=self["webpackChunkcafe_today"]||[]).push([[187],{7258:function(e,l,a){a.d(l,{A:function(){return o}});var t=a(144);function o(e){const l=(0,t.KR)(!1),a=(0,t.KR)(!1),o=(0,t.KR)(""),s=function(e){return new Promise((l=>{setTimeout((()=>{console.log(`已等待 ${e} 毫秒`),l()}),e)}))},n=async function(){l.value=!0,a.value=!1,o.value="";try{await s(3e3);const l=Math.floor(Math.random()*e.value.length);o.value=e.value[l],a.value=!0}catch(t){console.error("抽籤過程發生錯誤:",t)}finally{l.value=!1}};return{selectedShop:o,isDestiny:l,isDestinyDone:a,getDestinyShop:n}}},5785:function(e,l,a){a.d(l,{A:function(){return o}});var t=a(144);function o(){const e=(0,t.KR)(!1),l=(0,t.KR)(""),a=(0,t.KR)("success"),o=(t,o="success")=>{l.value=t,a.value=o,e.value=!0},s=()=>{e.value=!1};return{showModal:e,modalMessage:l,modalType:a,openModal:o,closeModal:s}}},2136:function(e,l,a){a.d(l,{A:function(){return d}});var t=a(6768),o=a(4232);const s={key:0,class:"modal-overlay"},n={class:"modal-type"},c={class:"modal-message light-bold-text"};var u={__name:"ModalBox",props:{visible:Boolean,message:String,type:{type:String,default:"success"}},emits:["close"],setup(e,{emit:l}){const a=e,u=(0,t.EW)((()=>"success"===a.type?"modal-text-green":"modal-text-red")),r=(0,t.EW)((()=>"success"===a.type?"成功！":"錯誤！")),i=l,d=()=>{i("close")};return(l,a)=>e.visible?((0,t.uX)(),(0,t.CE)("div",s,[(0,t.Lk)("div",{class:(0,o.C4)(["modal-box",u.value])},[(0,t.Lk)("p",n,(0,o.v_)(r.value),1),(0,t.Lk)("p",c,(0,o.v_)(e.message),1),(0,t.Lk)("button",{class:"button click-color-light",onClick:d},"確定")],2)])):(0,t.Q3)("",!0)}},r=a(1241);const i=(0,r.A)(u,[["__scopeId","data-v-584854f8"]]);var d=i},2008:function(e,l,a){a.r(l),a.d(l,{default:function(){return $}});var t=a(6768),o=a(4232),s=a(5130),n=a.p+"img/teaAndBook.0b869572.png";const c={class:"screen-center"},u={class:"container"},r=["value"],i={key:0,class:"table-border"},d=["id"],v={class:"table-td border-b"},b={class:"table-td border-b"},p={class:"table-td border-b"},g=["href"],h={class:"table-td border-b"},k={class:"checkout"},y=["disabled"];function m(e,l,a,m,f,L){const _=(0,t.g2)("LoadingOverlay"),S=(0,t.g2)("ModalBox");return(0,t.uX)(),(0,t.CE)(t.FK,null,[(0,t.bF)(_,{active:m.isLoading,color:"#79716b"},null,8,["active"]),(0,t.Lk)("div",c,[l[10]||(l[10]=(0,t.Lk)("p",{class:"slogan"},"尋找你的咖啡靈魂",-1)),(0,t.Lk)("div",u,[l[3]||(l[3]=(0,t.Lk)("label",{for:"dropdown",class:"label"},"選擇城市：",-1)),(0,t.bo)((0,t.Lk)("select",{id:"dropdown","onUpdate:modelValue":l[0]||(l[0]=e=>m.selectedOption=e),class:"select"},[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(m.options,(e=>((0,t.uX)(),(0,t.CE)("option",{key:e.value,value:e.value},(0,o.v_)(e.label),9,r)))),128))],512),[[s.u1,m.selectedOption]])]),(0,t.bF)(s.eB,null,{default:(0,t.k6)((()=>[m.isDestinyDone?((0,t.uX)(),(0,t.CE)("div",i,[(0,t.Lk)("table",{class:"table-all",id:`item-${m.selectedShop.id}`},[(0,t.Lk)("tr",null,[l[4]||(l[4]=(0,t.Lk)("th",{class:"table-td border-b border-r w-25 text-nowrap"},"店家名稱",-1)),(0,t.Lk)("td",v,(0,o.v_)(m.selectedShop.name||"無"),1)]),(0,t.Lk)("tr",null,[l[5]||(l[5]=(0,t.Lk)("th",{class:"table-td border-b border-r w-25 text-nowrap"},"城市",-1)),(0,t.Lk)("td",b,(0,o.v_)(m.selectedShop.city||"無"),1)]),(0,t.Lk)("tr",null,[l[8]||(l[8]=(0,t.Lk)("th",{class:"table-td border-b border-r"},"地址",-1)),(0,t.Lk)("td",p,[(0,t.Lk)("a",{href:`https://www.google.com/maps/search/${encodeURIComponent(m.selectedShop.name)}`,target:"_blank",rel:"noreferrer noopener",class:"underline"},[(0,t.eW)((0,o.v_)(m.selectedShop.address||"無"),1),l[6]||(l[6]=(0,t.Lk)("br",null,null,-1)),l[7]||(l[7]=(0,t.eW)(" (前往 Google 地圖) "))],8,g)])]),(0,t.Lk)("tr",null,[l[9]||(l[9]=(0,t.Lk)("th",{class:"table-td border-b border-r"},"營業時間",-1)),(0,t.Lk)("td",h,(0,o.v_)(m.selectedShop.open_time||"無"),1)])],8,d),(0,t.Lk)("div",k,[(0,t.Lk)("button",{onClick:l[1]||(l[1]=(...e)=>m.checkout&&m.checkout(...e)),class:"button click-color-mid"}," 點擊收藏到你的口袋名單 ")])])):(0,t.Q3)("",!0)])),_:1}),l[11]||(l[11]=(0,t.Lk)("p",{class:"text-xs text-stone-400"}," 營業時間可能不同，出發前請至官方網站確認 ",-1)),(0,t.Lk)("button",{class:"btn click-color-light",onClick:l[2]||(l[2]=(0,s.D$)(((...e)=>m.getDestinyShop&&m.getDestinyShop(...e)),["prevent"])),disabled:m.isDestiny||!m.selectedOption},(0,o.v_)(m.isDestiny?"抽籤中...":"點擊進行抽籤"),9,y),l[12]||(l[12]=(0,t.Lk)("img",{class:"image",src:n,alt:"teaAndBook"},null,-1))]),(0,t.bF)(S,{visible:m.showModal,message:m.modalMessage,type:m.modalType,onClose:m.closeModal},null,8,["visible","message","type","onClose"])],64)}a(4114),a(7642),a(8004),a(3853),a(5876),a(2475),a(5024),a(1698),a(8992),a(7550);var f=a(4373),L=a(144),_=a(594),S=a(7258),w=a(2136),D=a(5785),M=a(6638),C={name:"DestinyView",components:{ModalBox:w.A},setup(){const e=(0,L.KR)(""),l=(0,L.Kh)([{value:"",label:"請先選擇城市"},{value:"Keelung",label:"基隆"},{value:"taipei",label:"台北"},{value:"taoyuan",label:"桃園"},{value:"hsinchu",label:"新竹"},{value:"miaoli",label:"苗栗"},{value:"taichung",label:"台中"},{value:"changhua",label:"彰化"},{value:"nantou",label:"南投"},{value:"yunlin",label:"雲林"},{value:"chiayi",label:"嘉義"},{value:"tainan",label:"台南"},{value:"kaohsiung",label:"高雄"},{value:"pingtung",label:"屏東"},{value:"yilan",label:"宜蘭"},{value:"hualien",label:"花蓮"},{value:"taitung",label:"台東"},{value:"penghu",label:"澎湖"}]),a=(0,L.KR)([]),o=(0,L.KR)(!1),{showModal:s,modalMessage:n,modalType:c,openModal:u,closeModal:r}=(0,D.A)(),{selectedShop:i,isDestiny:d,isDestinyDone:v,getDestinyShop:b}=(0,S.A)(a),p=(0,L.KR)(new Set),g=async function(e){if(!e||p.value.has(e))return;const l=`cafe_data_${e}`,t=(0,M.J)(l);if(t)return a.value=t,p.value.add(e),void console.log(`城市 ${e} 資料已在 localStorage 中`);try{const a=(0,_.A)(e);console.log(`預加載城市 ${e} 資料，URL: ${a}`),setTimeout((async()=>{try{const t=await f.A.get(a);(0,M.d)(l,t.data),p.value.add(e),console.log(`城市 ${e} 資料預加載完成，共 ${t.data.length} 筆資料`)}catch(t){console.error(`預加載城市 ${e} 資料失敗:`,t)}}),0)}catch(o){console.error(`預加載城市 ${e} 資料準備失敗:`,o)}},h=function(){const e=["taipei","taichung","kaohsiung","tainan"];e.forEach((e=>{g(e)}))};h();const k=async function(){if(!e.value)return void u("請選擇一個城市！","error");const l=`cafe_data_${e.value}`,t=(0,M.J)(l);if(t)return a.value=t,void console.log("從 localStorage 獲取資料",e.value,a.value.length);const s=(0,_.A)(e.value);console.log("apiUrl路徑",s),o.value=!0;try{const t=await f.A.get(s);a.value=t.data,(0,M.d)(l,a.value),console.log("選擇城市的咖啡店資料已更新",e.value,a.value.length)}catch(n){console.error("API 請求失敗！",n),u("取得資料失敗，請重新整理後再試一次，謝謝！","error")}finally{o.value=!1}};(0,t.wB)(e,(e=>{e&&k()}));const y=()=>{const e=JSON.parse(localStorage.getItem("savedCafes")||"[]"),l=e.some((e=>e.id===i.value.id));if(l)return void u("此咖啡店已在你的口袋名單中！","error");const a={id:i.value.id,name:i.value.name,city:i.value.city,address:i.value.address,open_time:i.value.open_time};e.push(a),localStorage.setItem("savedCafes",JSON.stringify(e)),u("已成功收藏到你的口袋名單！","success")};return{selectedOption:e,options:l,selectedShop:i,shopData:a,isLoading:o,isDestiny:d,isDestinyDone:v,getData:k,getDestinyShop:b,showModal:s,closeModal:r,modalMessage:n,modalType:c,checkout:y}}},A=a(1241);const K=(0,A.A)(C,[["render",m],["__scopeId","data-v-6dd3b6bd"]]);var $=K}}]);